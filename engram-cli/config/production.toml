# Production configuration example for Engram
# Copy this file to your config directory and customize as needed

[feature_flags]
spreading_api_beta = true

[server]
# Bind to all interfaces in production
http_bind = "0.0.0.0"

[memory_spaces]
default_space = "default"
bootstrap_spaces = ["default"]

[persistence]
# Production data directory
data_root = "/var/lib/engram"

# Production capacity limits (adjust based on hardware)
hot_capacity = 500_000
warm_capacity = 5_000_000
cold_capacity = 50_000_000

[cluster]
enabled = false
node_id = ""

[cluster.discovery]
type = "static"
seed_nodes = []

[cluster.swim]
ping_interval = "1s"
ack_timeout = "600ms"
suspicion_timeout = "2s"
indirect_probes = 3
gossip_batch = 6

[cluster.replication]
factor = 3
timeout = "1s"
placement = "random"
jump_buckets = 16384
rack_penalty = 0.5
zone_penalty = 0.35
lag_threshold = "5s"
catch_up_batch_bytes = 2097152
compression = "lz4"
io_uring_enabled = false

[cluster.network]
swim_bind = "0.0.0.0:7946"
api_bind = "0.0.0.0:50051"
max_message_size = 4194304
connection_pool_size = 8

[cluster.partition]
majority_threshold = 0.6
detection_window = "10s"
check_interval = "2s"

[router]
connection_pool_size = 8
request_timeout_ms = 5000
max_retries = 3
retry_base_delay_ms = 100
retry_max_delay_ms = 1000
circuit_breaker_failure_threshold = 10
circuit_breaker_reset_ms = 10000
replica_fallback_enabled = true
replica_fallback_lag_sequences = 32
default_read_strategy = "nearest_replica"

[security]
# Enable authentication in production
auth_mode = "api_key"
rate_limiting = true

[security.api_keys]
backend = "file"
storage_path = "/var/lib/engram/api_keys.db"
rotation_days = 30
warn_before_expiry_days = 7

[security.cors]
# Restrict origins to your production domains
allowed_origins = ["https://app.example.com"]
allowed_methods = ["GET", "POST", "DELETE", "OPTIONS"]
max_age_seconds = 3600
